import{r as t,j as e,C as D}from"./index-DUfxMsBG.js";import{c as y,d as j,a as p,b as L,e as O}from"./auth-q2UnZPLo.js";import{C as k,a as B,b as M,c as U,d as H,e as P,f as q,g as R,h as z}from"./cil-trash-2s-ugeRC.js";import{C as $,a as C}from"./CFormInput-Cbdb-K5P.js";import{C as A,j as J}from"./DefaultLayout-DP4gFdW4.js";import{l as V,d as G,u as K,c as Q}from"./officers-kgChqHOq.js";import{C as W,a as X}from"./CCardBody-llveuZcH.js";import{C as Y}from"./CCardHeader-BnOoQjEp.js";import{C as Z,a as _,b as T,c as m,d as ee,e as h}from"./CTable-RJjthtCV.js";const se=({visible:o,onClose:u,onSave:f,initial:r=null})=>{const[d,n]=t.useState(""),[l,c]=t.useState(""),[x,v]=t.useState(""),[N,b]=t.useState(""),[s,i]=t.useState(""),[g,S]=t.useState(""),[w,E]=t.useState("Active");t.useEffect(()=>{o&&(r?(console.log("Editing officer:",r),n(r.name||""),c(r.lastName||""),v(r.idNumber||""),b(r.unit||""),i(r.email||""),S(r.phone||""),E(r.status||"Active")):(console.log("Creating new officer"),n(""),c(""),v(""),b(""),i(""),S(""),E("Active")))},[o,r]);const F=a=>{if(a.preventDefault(),console.log("Form submitted with:",{name:d,lastName:l,idNumber:x,unit:N,email:s,phone:g,status:w}),!d.trim()||!l.trim()){alert("Name and Last Name are required");return}const I={name:d.trim(),lastName:l.trim(),idNumber:x.trim(),unit:N.trim(),email:s.trim(),phone:g.trim(),status:w};f(I)};return e.jsxs(k,{size:"lg",visible:o,onClose:u,children:[e.jsx(B,{children:e.jsx(M,{children:r?"Edit Officer":"New Officer"})}),e.jsxs($,{onSubmit:F,children:[e.jsxs(U,{children:[e.jsxs(y,{className:"g-3",children:[e.jsx(j,{md:6,children:e.jsx(C,{label:"Name *",placeholder:"John",value:d,onChange:a=>n(a.target.value),required:!0})}),e.jsx(j,{md:6,children:e.jsx(C,{label:"Last Name *",placeholder:"Doe",value:l,onChange:a=>c(a.target.value),required:!0})})]}),e.jsxs(y,{className:"g-3 mt-2",children:[e.jsx(j,{md:6,children:e.jsx(C,{label:"ID Number",placeholder:"V-12345678",value:x,onChange:a=>v(a.target.value)})}),e.jsx(j,{md:6,children:e.jsx(C,{label:"Unit",placeholder:"CICPC - Homicides",value:N,onChange:a=>b(a.target.value)})})]}),e.jsxs(y,{className:"g-3 mt-2",children:[e.jsx(j,{md:6,children:e.jsx(C,{label:"Email",type:"email",placeholder:"john.doe@example.com",value:s,onChange:a=>i(a.target.value)})}),e.jsx(j,{md:6,children:e.jsx(C,{label:"Phone",placeholder:"0414-1234567",value:g,onChange:a=>S(a.target.value)})})]}),e.jsx("div",{className:"mt-3",children:e.jsxs(H,{label:"Status *",value:w,onChange:a=>E(a.target.value),children:[e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"}),e.jsx("option",{value:"Training",children:"Training"}),e.jsx("option",{value:"Suspended",children:"Suspended"})]})}),e.jsx("div",{className:"mt-3",children:e.jsx("small",{className:"text-muted",children:"* Required fields"})})]}),e.jsxs(P,{children:[e.jsx(p,{color:"secondary",onClick:u,children:"Cancel"}),e.jsxs(p,{type:"submit",color:"primary",children:[r?"Update":"Create"," Officer"]})]})]})]})},re=({name:o="",lastName:u="",src:f,color:r="primary",textColor:d="white",size:n})=>{const l=`${(o||"").trim()[0]||""}${(u||"").trim()[0]||""}`.toUpperCase();return f?e.jsx(A,{src:f,size:n}):e.jsx(A,{color:r,textColor:d,size:n,children:l||"U"})},he=()=>{const[o,u]=t.useState([]),[f,r]=t.useState(!0),[d,n]=t.useState(!1),[l,c]=t.useState(null);t.useEffect(()=>{console.log("Officers component mounted"),x()},[]);async function x(){console.log("Fetching officers..."),r(!0);try{const s=await V();console.log("Officers loaded:",s),u(s||[])}catch(s){console.error("Error fetching officers:",s),u([])}finally{r(!1)}}async function v(s){console.log("Saving officer:",s);try{l&&l.id?await K(l.id,s):await Q(s),n(!1),c(null),await x()}catch(i){console.error("Error saving officer:",i),alert("Error saving officer: "+i.message)}}async function N(s){if(window.confirm("Are you sure you want to delete this officer?"))try{await G(s),await x()}catch(i){console.error("Error deleting officer:",i),alert("Error deleting officer: "+i.message)}}const b=s=>{const g={Active:{color:"success",text:"Active"},Inactive:{color:"danger",text:"Inactive"},Training:{color:"warning",text:"Training"},Suspended:{color:"secondary",text:"Suspended"}}[s]||{color:"secondary",text:s};return e.jsx(J,{color:g.color,children:g.text})};return e.jsxs(L,{fluid:!0,children:[e.jsx(y,{children:e.jsx(j,{children:e.jsxs(W,{children:[e.jsx(Y,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h4",{className:"mb-0",children:"Officers Management"}),e.jsxs(p,{color:"primary",onClick:()=>{console.log("New officer button clicked"),c(null),n(!0)},children:[e.jsx(O,{icon:q,className:"me-2"}),"New Officer"]})]})}),e.jsx(X,{children:f?e.jsxs("div",{className:"text-center py-4",children:[e.jsx(D,{color:"primary"}),e.jsx("div",{className:"mt-2",children:"Loading officers..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-3 text-muted",children:["Showing ",o.length," officer(s)"]}),o.length>0?e.jsxs(Z,{hover:!0,responsive:!0,children:[e.jsx(_,{children:e.jsxs(T,{children:[e.jsx(m,{style:{width:"70px"}}),e.jsx(m,{children:"ID"}),e.jsx(m,{children:"Name"}),e.jsx(m,{children:"Last Name"}),e.jsx(m,{children:"ID Number"}),e.jsx(m,{children:"Unit"}),e.jsx(m,{children:"Status"}),e.jsx(m,{style:{width:"150px"},children:"Actions"})]})}),e.jsx(ee,{children:o.map(s=>e.jsxs(T,{children:[e.jsx(h,{children:e.jsx(re,{name:s.name,lastName:s.lastName})}),e.jsxs(h,{children:["#",s.id]}),e.jsx(h,{children:e.jsx("strong",{children:s.name})}),e.jsx(h,{children:s.lastName||"-"}),e.jsx(h,{children:s.idNumber||"-"}),e.jsx(h,{children:s.unit}),e.jsx(h,{children:b(s.status)}),e.jsx(h,{children:e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(p,{size:"sm",color:"primary",variant:"outline",onClick:()=>{console.log("Editing officer:",s),c(s),n(!0)},children:e.jsx(O,{icon:R})}),e.jsx(p,{size:"sm",color:"danger",variant:"outline",onClick:()=>N(s.id),children:e.jsx(O,{icon:z})})]})})]},s.id))})]}):e.jsx("div",{className:"text-center py-5",children:e.jsxs("div",{className:"text-muted",children:[e.jsx("h5",{children:"No officers found"}),e.jsx("p",{children:"Start by adding a new officer to the system."}),e.jsx(p,{color:"primary",onClick:()=>{c(null),n(!0)},children:"Add First Officer"})]})})]})})]})})}),e.jsx(se,{visible:d,onClose:()=>{console.log("Closing form"),n(!1),c(null)},onSave:v,initial:l})]})};export{he as default};
