import{r as l,_ as F,R,c as I,P as f,j as e,C as N}from"./index-DUfxMsBG.js";import{b as P,c as C,d as u,e as j,g as _,a as w}from"./auth-q2UnZPLo.js";import{k as B,j as T,u as k,l as z}from"./DefaultLayout-DP4gFdW4.js";import{C as S,a as A}from"./CCardBody-llveuZcH.js";import{C as O}from"./CCardHeader-BnOoQjEp.js";import{C as q}from"./CAlert-ClAHz7tk.js";import{C as U,a as p}from"./CFormInput-Cbdb-K5P.js";import{C as Y}from"./CFormTextarea-DH0Xj6EK.js";const v=l.forwardRef((a,h)=>{var{align:i,className:x,fluid:d,rounded:m,thumbnail:g}=a,b=F(a,["align","className","fluid","rounded","thumbnail"]);return R.createElement("img",Object.assign({className:I({[`float-${i}`]:i&&(i==="start"||i==="end"),"d-block mx-auto":i&&i==="center","img-fluid":d,rounded:m,"img-thumbnail":g},x)||void 0},b,{ref:h}))});v.propTypes={align:f.oneOf(["start","center","end"]),className:f.string,fluid:f.bool,rounded:f.bool,thumbnail:f.bool};v.displayName="CImage";var $=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M471.993,112h-89.2L366.551,65.25a32.023,32.023,0,0,0-30.229-21.5H175.241a31.991,31.991,0,0,0-30.294,21.691L129.1,112h-89.1a24.027,24.027,0,0,0-24,24V448a24.027,24.027,0,0,0,24,24H471.993a24.027,24.027,0,0,0,24-24V136A24.027,24.027,0,0,0,471.993,112Zm-8,328H48.007V144h104.01l23.224-68.25H336.322L360.032,144H463.993Z' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M256,168A114,114,0,1,0,370,282,114.13,114.13,0,0,0,256,168Zm0,196a82,82,0,1,1,82-82A82.093,82.093,0,0,1,256,364Z' class='ci-primary'/>"],W=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M472.971,122.344,373.656,23.029A23.838,23.838,0,0,0,356.687,16H56A24.028,24.028,0,0,0,32,40V472a24.028,24.028,0,0,0,24,24H456a24.028,24.028,0,0,0,24-24V139.313A23.838,23.838,0,0,0,472.971,122.344ZM320,48v96H176V48ZM448,464H64V48h80V176H352V48h1.373L448,142.627Z' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M252,224a92,92,0,1,0,92,92A92.1,92.1,0,0,0,252,224Zm0,152a60,60,0,1,1,60-60A60.068,60.068,0,0,1,252,376Z' class='ci-primary'/>"];const le=()=>{const[a,h]=l.useState(null),[i,x]=l.useState(!0),[d,m]=l.useState(!1),[g,b]=l.useState("personal"),[y,n]=l.useState({type:"",text:""}),[t,o]=l.useState({}),[G,J]=l.useState({currentPassword:"",newPassword:"",confirmPassword:""});l.useEffect(()=>{D()},[]);const D=async()=>{x(!0);try{const r=await B();h(r),o({first_name:r.first_name||"",last_name:r.last_name||"",gmail:r.gmail||"",number_phone:r.number_phone||"",bio:r.bio||"",department:r.department||"",location:r.location||""})}catch(r){console.error("Error loading profile:",r),n({type:"danger",text:"Error loading profile"})}finally{x(!1)}},E=async r=>{const s=r.target.files[0];if(s){if(!s.type.startsWith("image/")){n({type:"danger",text:"Please select an image file"});return}if(s.size>5*1024*1024){n({type:"danger",text:"Image size should be less than 5MB"});return}try{m(!0);const c=new FileReader;c.onload=async M=>{const V=M.target.result,Z=await k(V);h(Z),n({type:"success",text:"Profile picture updated successfully"})},c.readAsDataURL(s)}catch(c){console.error("Error updating profile picture:",c),n({type:"danger",text:"Error updating profile picture"})}finally{m(!1)}}},H=async r=>{r.preventDefault(),m(!0);try{const s=await z(t);h(s),n({type:"success",text:"Profile updated successfully"})}catch(s){console.error("Error updating profile:",s),n({type:"danger",text:"Error updating profile"})}finally{m(!1)}},L=r=>{const c={administrador:{color:"danger",text:"Administrator"},oficial:{color:"primary",text:"Officer"},funcionario:{color:"info",text:"Official"},civil:{color:"success",text:"Civil"}}[r]||{color:"secondary",text:r};return e.jsx(T,{color:c.color,children:c.text})};return i?e.jsx(P,{fluid:!0,children:e.jsxs("div",{className:"text-center py-5",children:[e.jsx(N,{color:"primary"}),e.jsx("div",{className:"mt-3",children:"Loading profile..."})]})}):e.jsx(P,{fluid:!0,children:e.jsxs(C,{children:[e.jsx(u,{lg:4,md:12,children:e.jsx(S,{className:"mb-4",children:e.jsxs(A,{className:"text-center",children:[e.jsxs("div",{className:"position-relative d-inline-block",children:[a?.profile_picture?e.jsx(v,{src:a.profile_picture,alt:"Profile",className:"rounded-circle mb-3",width:150,height:150,style:{objectFit:"cover"}}):e.jsx("div",{className:"rounded-circle bg-secondary d-flex align-items-center justify-content-center text-white mb-3 mx-auto",style:{width:150,height:150},children:e.jsx(j,{icon:_,size:"3xl"})}),e.jsxs("label",{htmlFor:"profile-picture-upload",className:"btn btn-primary btn-sm rounded-circle position-absolute",style:{bottom:"20px",right:"20px",cursor:"pointer"},title:"Change profile picture",children:[e.jsx(j,{icon:$}),e.jsx("input",{id:"profile-picture-upload",type:"file",accept:"image/*",onChange:E,style:{display:"none"},disabled:d})]})]}),e.jsxs("h4",{children:[a?.first_name," ",a?.last_name]}),e.jsx("p",{className:"text-muted",children:a?.gmail}),a?.role&&L(a.role),e.jsxs("div",{className:"mt-3 text-start",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Document:"})," ",a?.document]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Phone:"})," ",a?.number_phone]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Department:"})," ",a?.department||"Not specified"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Location:"})," ",a?.location||"Not specified"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Member since:"})," ",a?.join_date||"2024"]})]})]})})}),e.jsx(u,{lg:8,md:12,children:e.jsxs(S,{children:[e.jsx(O,{children:e.jsx("div",{className:"d-flex border-bottom",children:e.jsxs(w,{color:"link",className:`me-3 ${g==="personal"?"text-primary border-primary border-bottom":"text-muted"}`,onClick:()=>b("personal"),children:[e.jsx(j,{icon:_,className:"me-2"}),"Personal Information"]})})}),e.jsxs(A,{children:[y.text&&e.jsx(q,{color:y.type,className:"mb-3",children:y.text}),g==="personal"&&e.jsxs(U,{onSubmit:H,children:[e.jsx("h5",{className:"mb-4",children:"Personal Information"}),e.jsxs(C,{className:"g-3",children:[e.jsx(u,{md:6,children:e.jsx(p,{label:"First Name *",value:t.first_name||"",onChange:r=>o({...t,first_name:r.target.value}),required:!0})}),e.jsx(u,{md:6,children:e.jsx(p,{label:"Last Name *",value:t.last_name||"",onChange:r=>o({...t,last_name:r.target.value}),required:!0})})]}),e.jsxs(C,{className:"g-3 mt-2",children:[e.jsx(u,{md:6,children:e.jsx(p,{label:"Email *",type:"email",value:t.gmail||"",onChange:r=>o({...t,gmail:r.target.value}),required:!0})}),e.jsx(u,{md:6,children:e.jsx(p,{label:"Phone Number",value:t.number_phone||"",onChange:r=>o({...t,number_phone:r.target.value})})})]}),e.jsx("div",{className:"mt-3",children:e.jsx(p,{label:"Department",value:t.department||"",onChange:r=>o({...t,department:r.target.value}),placeholder:"Your department or unit"})}),e.jsx("div",{className:"mt-3",children:e.jsx(p,{label:"Location",value:t.location||"",onChange:r=>o({...t,location:r.target.value}),placeholder:"Your city and country"})}),e.jsx("div",{className:"mt-3",children:e.jsx(Y,{label:"Bio",rows:"3",value:t.bio||"",onChange:r=>o({...t,bio:r.target.value}),placeholder:"Tell us about yourself..."})}),e.jsx("div",{className:"mt-4",children:e.jsxs(w,{type:"submit",color:"primary",disabled:d,children:[d?e.jsx(N,{size:"sm"}):e.jsx(j,{icon:W}),d?" Saving...":" Save Changes"]})})]})]})]})})]})})};export{le as default};
